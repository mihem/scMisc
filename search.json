[{"path":"https://mihem.github.io/scMisc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 scUtils authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mihem.github.io/scMisc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Heming. Author, maintainer.","code":""},{"path":"https://mihem.github.io/scMisc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Heming M (2025). scMisc: Utils scRNA-seq. R package version 0.5.0, https://github.com/mihem/scMisc.","code":"@Manual{,   title = {scMisc: Utils for scRNA-seq},   author = {Michael Heming},   year = {2025},   note = {R package version 0.5.0},   url = {https://github.com/mihem/scMisc}, }"},{"path":"https://mihem.github.io/scMisc/index.html","id":"scmisc","dir":"","previous_headings":"","what":"Utils for scRNA-seq","title":"Utils for scRNA-seq","text":"scMisc R package provides helper functions scRNA-seq analysis focus Seurat.","code":""},{"path":"https://mihem.github.io/scMisc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Utils for scRNA-seq","text":"install package, use:","code":"remotes::install_github(\"mihem/scMisc\")"},{"path":"https://mihem.github.io/scMisc/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Utils for scRNA-seq","text":"find use package, please refer vignette.","code":""},{"path":"https://mihem.github.io/scMisc/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Utils for scRNA-seq","text":"questions, please contact via mheming.de.","code":""},{"path":"https://mihem.github.io/scMisc/reference/ModulePlot.html","id":null,"dir":"Reference","previous_headings":"","what":"module plot — ModulePlot","title":"module plot — ModulePlot","text":"create combined violin boxplot module score","code":""},{"path":"https://mihem.github.io/scMisc/reference/ModulePlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"module plot — ModulePlot","text":"","code":"ModulePlot(x_var, module, object, color)"},{"path":"https://mihem.github.io/scMisc/reference/ModulePlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"module plot — ModulePlot","text":"x_var variable meta data represents x-axis module variable meta data module score object Seurat object color color palette","code":""},{"path":"https://mihem.github.io/scMisc/reference/ModulePlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"module plot — ModulePlot","text":"plot module plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/ModulePlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"module plot — ModulePlot","text":"","code":"library(Seurat) #> Loading required package: SeuratObject #> Loading required package: sp #> ‘SeuratObject’ was built under R 4.5.0 but the current version is #> 4.5.2; it is recomended that you reinstall ‘SeuratObject’ as the ABI #> for R may have changed #>  #> Attaching package: ‘SeuratObject’ #> The following objects are masked from ‘package:base’: #>  #>     intersect, t set.seed(123) pbmc_small$AIE_type <- sample(c(\"control\", \"CASPR2\", \"LGI1\"), ncol(pbmc_small), replace = TRUE) module1 <- list(c(rownames(pbmc_small)[1:100])) pbmc_small <- AddModuleScore(   pbmc_small,   features = module1,   assay = \"RNA\",   name = \"module\",   ctrl = 5 ) ModulePlot(   x_var = \"AIE_type\",   module = \"module1\",   object = pbmc_small,   color = c(\"control\" = \"blue\", \"CASPR2\" = \"red\", \"LGI1\" = \"green\") ) #> Warning: Using formula(x) is deprecated when x is a character vector of length > 1. #>   Consider formula(paste(x, collapse = \" \")) instead."},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":null,"dir":"Reference","previous_headings":"","what":"Load CellBender h5 matrices — ReadCellBender_h5","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"Extract sparse matrix corrected counts CellBender h5 output file.","code":""},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"","code":"ReadCellBender_h5(file_name, use.names = TRUE, unique.features = TRUE)"},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"file_name Path h5 file. use.names Label row names feature names rather ID numbers (default TRUE). unique.features Make feature names unique (default TRUE).","code":""},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"sparse matrix","code":""},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"Code used function modified Seurat::Read10X_h5 function Seurat package https://github.com/satijalab/seurat (License: GPL-3).","code":""},{"path":"https://mihem.github.io/scMisc/reference/ReadCellBender_h5.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load CellBender h5 matrices — ReadCellBender_h5","text":"","code":"file_name <- system.file(\"extdata\", \"raw_feature_bc_matrix_filtered.h5\", package = \"scMisc\") mat <- ReadCellBender_h5(file_name)"},{"path":"https://mihem.github.io/scMisc/reference/abBoxPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"abundance boxplot plot — abBoxPlot","title":"abundance boxplot plot — abBoxPlot","text":"create save abundance boxplot folder abundance","code":""},{"path":"https://mihem.github.io/scMisc/reference/abBoxPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"abundance boxplot plot — abBoxPlot","text":"","code":"abBoxPlot(   object,   cluster_idents,   sample,   cluster_order,   group_by,   group_order,   color,   width = 9,   height = ceiling(length(unique(object@meta.data[[cluster_idents]]))/4) * 3,   paired = FALSE,   number_of_tests,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/abBoxPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"abundance boxplot plot — abBoxPlot","text":"object Seurat object cluster_idents variable meta data cluster names sample variable meta data sample cluster_order vector determining order clusters group_by variable meta data categorize samples groups group_order vector determining order samples color color palette width width output plot (default: 9) height height output plot (default: length cluster_idents divided four, ceiling, times three) paired logical indicating whether want paired test (default FALSE) number_of_tests number tests performed dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/abBoxPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"abundance boxplot plot — abBoxPlot","text":"save abundance box plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/abBoxPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"abundance boxplot plot — abBoxPlot","text":"","code":"library(Seurat) set.seed(123) pbmc_small$cluster <-   sample(c(\"Cluster1\", \"Cluster2\"),     ncol(pbmc_small),     replace = TRUE   ) pbmc_small$sample <-   sample(c(\"CSF_P01\", \"CSF_P02\", \"CSF_P03\", \"CSF_P04\"),     ncol(pbmc_small),     replace = TRUE   ) lookup <-   data.frame(     sample = c(\"CSF_P01\", \"CSF_P02\", \"CSF_P03\", \"CSF_P04\"),     AIE_type = c(rep(\"control\", 2), rep(\"CASPR2\", 2))   ) pbmc_small@meta.data <-   pbmc_small@meta.data |>   tibble::rownames_to_column(\"barcode\") |>   dplyr::left_join(lookup, by = \"sample\") |>   tibble::column_to_rownames(\"barcode\") abBoxPlot(   object = pbmc_small,   cluster_idents = \"cluster\",   sample = \"sample\",   cluster_order = c(\"Cluster1\", \"Cluster2\"),   group_by = \"AIE_type\",   group_order = c(\"control\", \"CASPR2\"),   color = c(\"control\" = \"blue\", \"CASPR2\" = \"red\"),   width = 9,   height = 6,   paired = FALSE,   number_of_tests = 3,   dir_output = \".\" ) #> Joining with `by = join_by(sample)` #> Warning: Computation failed in `stat_signif()`. #> Caused by error in `$<-.data.frame`: #> ! replacement has 1 row, data has 0 #> `geom_line()`: Each group consists of only one observation. #> ℹ Do you need to adjust the group aesthetic? #> Warning: Computation failed in `stat_signif()`. #> Caused by error in `$<-.data.frame`: #> ! replacement has 1 row, data has 0 #> `geom_line()`: Each group consists of only one observation. #> ℹ Do you need to adjust the group aesthetic? #> Warning: Computation failed in `stat_signif()`. #> Caused by error in `$<-.data.frame`: #> ! replacement has 1 row, data has 0 #> `geom_line()`: Each group consists of only one observation. #> ℹ Do you need to adjust the group aesthetic? #> Warning: Computation failed in `stat_signif()`. #> Caused by error in `$<-.data.frame`: #> ! replacement has 1 row, data has 0 #> `geom_line()`: Each group consists of only one observation. #> ℹ Do you need to adjust the group aesthetic?  unlink(\"boxplot_cluster_pbmc_small_AIE_type.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/abVolPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"abundance volcano plot — abVolPlot","title":"abundance volcano plot — abVolPlot","text":"create save abundance volcano bar plot folder abundance","code":""},{"path":"https://mihem.github.io/scMisc/reference/abVolPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"abundance volcano plot — abVolPlot","text":"","code":"abVolPlot(   object,   cluster_idents,   sample,   cluster_order,   group_by,   group1,   group2,   color,   width = 5,   height = 5,   min_cells = 10,   paired = FALSE,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/abVolPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"abundance volcano plot — abVolPlot","text":"object Seurat object cluster_idents variable meta data cluster names sample variable meta data sample cluster_order vector determining order clusters group_by variable meta data categorize samples groups group1 first group (nominator) group2 second group (denominator) color color palette width width output plot (default: 5) height height output plot (default: 5) min_cells remove clusters less minimal amount cells (default = 10) paired logical indicating whether want paired test (default FALSE) dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/abVolPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"abundance volcano plot — abVolPlot","text":"save volcano abundance plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/abVolPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"abundance volcano plot — abVolPlot","text":"","code":"library(Seurat) library(rstatix) #>  #> Attaching package: ‘rstatix’ #> The following object is masked from ‘package:stats’: #>  #>     filter set.seed(123) pbmc_small$predicted.id <- sample(c(\"Cluster1\", \"Cluster2\"), ncol(pbmc_small), replace = TRUE) pbmc_small$sample <- sample(c(\"Sample1\", \"Sample2\"), ncol(pbmc_small), replace = TRUE) pbmc_small$AIE_type <- sample(c(\"LGI1\", \"control\"), ncol(pbmc_small), replace = TRUE) abVolPlot(   object = pbmc_small,   cluster_idents = \"predicted.id\",   sample = \"sample\",   cluster_order = c(\"Cluster1\", \"Cluster2\"),   group_by = \"AIE_type\",   group1 = \"LGI1\",   group2 = \"control\",   color = c(\"Cluster1\" = \"blue\", \"Cluster2\" = \"red\"),   width = 5,   height = 5,   dir_output = \".\" ) #> Joining with `by = join_by(sample)`  unlink(\"volcano_plot_predicted.id_pbmc_small_LGI1_control.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/abundanceTbl.html","id":null,"dir":"Reference","previous_headings":"","what":"wrapper function to calculate absolute and relative abundance — abundanceTbl","title":"wrapper function to calculate absolute and relative abundance — abundanceTbl","text":"wrapper function calculate absolute relative abundance","code":""},{"path":"https://mihem.github.io/scMisc/reference/abundanceTbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"wrapper function to calculate absolute and relative abundance — abundanceTbl","text":"","code":"abundanceTbl(object, row_var, col_var, dir_output = \".\")"},{"path":"https://mihem.github.io/scMisc/reference/abundanceTbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"wrapper function to calculate absolute and relative abundance — abundanceTbl","text":"object Seurat object row_var variable meta data represent rows col_var variable meta data represent columns dir_output target directory save results (default: .)","code":""},{"path":"https://mihem.github.io/scMisc/reference/abundanceTbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"wrapper function to calculate absolute and relative abundance — abundanceTbl","text":"","code":"library(Seurat) abundanceTbl(pbmc_small, row_var = \"groups\", col_var = \"letter.idents\") unlink(\"abundance_tbl_pbmc_small_letter.idents.xlsx\")"},{"path":"https://mihem.github.io/scMisc/reference/avgExp.html","id":null,"dir":"Reference","previous_headings":"","what":"wrapper function for Seurats AverageExpression — avgExp","title":"wrapper function for Seurats AverageExpression — avgExp","text":"create average expression matrix Seurat based markers.csv","code":""},{"path":"https://mihem.github.io/scMisc/reference/avgExp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"wrapper function for Seurats AverageExpression — avgExp","text":"","code":"avgExp(par, object, assay, slot, ortho = \"none\")"},{"path":"https://mihem.github.io/scMisc/reference/avgExp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"wrapper function for Seurats AverageExpression — avgExp","text":"par column name markers.csv object Seurat object assay assay use slot slot use ortho convert orthologues? Allowed values: none, mouse2human human2mouse","code":""},{"path":"https://mihem.github.io/scMisc/reference/avgExp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"wrapper function for Seurats AverageExpression — avgExp","text":"matrix genes rows identity clases columns","code":""},{"path":"https://mihem.github.io/scMisc/reference/avgExp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"wrapper function for Seurats AverageExpression — avgExp","text":"","code":"library(Seurat) markers <- data.frame(Bc = c(\"CD19\", \"MS4A1\", \"CD79B\")) write.csv(markers, \"markers.csv\") avgExp(\"Bc\", object = pbmc_small, assay = \"RNA\", slot = \"data\") #> New names: #> • `` -> `...1` #> Rows: 3 Columns: 2 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \",\" #> chr (1): Bc #> dbl (1): ...1 #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #> As of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis. #> This message is displayed once per session. #> First group.by variable `ident` starts with a number, appending `g` to ensure valid variable names #> This message is displayed once every 8 hours. #> 3 x 3 sparse Matrix of class \"dgCMatrix\" #>             g0        g1        g2 #> CD19   .        .         33.19047 #> MS4A1  .        2.083443 171.61521 #> CD79B 10.81466 17.548842 152.13441 unlink(\"markers.csv\")"},{"path":"https://mihem.github.io/scMisc/reference/calculatePropellerPermFDP.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate permFDP-adjusted threshold for propeller results — calculatePropellerPermFDP","title":"Calculate permFDP-adjusted threshold for propeller results — calculatePropellerPermFDP","text":"Internal helper function calculate permFDP-adjusted significance threshold propeller differential abundance testing","code":""},{"path":"https://mihem.github.io/scMisc/reference/calculatePropellerPermFDP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate permFDP-adjusted threshold for propeller results — calculatePropellerPermFDP","text":"","code":"calculatePropellerPermFDP(   prop_data,   seu_obj,   sample_col,   cluster_col,   meta_col,   lookup,   cond1,   cond2,   fdr_threshold,   n_perms = 1000 )"},{"path":"https://mihem.github.io/scMisc/reference/calculatePropellerPermFDP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate permFDP-adjusted threshold for propeller results — calculatePropellerPermFDP","text":"prop_data dataframe containing propeller results P.Value column seu_obj Seurat object subset two conditions compared sample_col character representing name sample column cluster_col character representing name cluster column meta_col character representing name condition column lookup dataframe containing sample condition mapping cond1 character representing first condition cond2 character representing second condition fdr_threshold FDR threshold use permFDP adjustment n_perms Number permutations permFDP adjustment (default: 1000)","code":""},{"path":"https://mihem.github.io/scMisc/reference/calculatePropellerPermFDP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate permFDP-adjusted threshold for propeller results — calculatePropellerPermFDP","text":"dataframe added permFDP_sig permFDP_threshold columns","code":""},{"path":"https://mihem.github.io/scMisc/reference/clustifyFun.html","id":null,"dir":"Reference","previous_headings":"","what":"clustifyr UMAP heatmap wrap — clustifyFun","title":"clustifyr UMAP heatmap wrap — clustifyFun","text":"create save clustifyr UMAP heatmap","code":""},{"path":"https://mihem.github.io/scMisc/reference/clustifyFun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"clustifyr UMAP heatmap wrap — clustifyFun","text":"","code":"clustifyFun(   my_object,   my_annotations,   ref_object,   ref_annotations,   format,   ortho = \"none\",   filter = FALSE,   regex = \"\",   umap = FALSE,   width = 10,   height = 7,   cluster_rows = TRUE,   cluster_cols = TRUE,   cellwidth = 10,   cellheight = 10,   fontsize = 10,   color,   name )"},{"path":"https://mihem.github.io/scMisc/reference/clustifyFun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"clustifyr UMAP heatmap wrap — clustifyFun","text":"my_object query input object my_annotations annotations query input object ref_object reference object ref_annotations reference annotations format format reference object: possible values seurat, sc matrix ortho convert orthologues? Allowed values: none, mouse2human human2mouse (default: none) filter reference filtered? Allowed values: TRUE, FALSE (default: FALSE) regex filter: specify filter term umap also create UMAP? Allowed values: TRUE, FALSE (default FALSE) width width heatmap plot (default: 10) height height heatmap plot (default: 7) cluster_rows cluster rows? (default: true) cluster_cols cluster columns? (default: true) cellwidth individual cell width (default: 10) cellheight individual cell height (default: 10) fontsize fontsize (default: 10) color color palette name fontsize (default: 10)","code":""},{"path":"https://mihem.github.io/scMisc/reference/clustifyFun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"clustifyr UMAP heatmap wrap — clustifyFun","text":"save umap/heatmap plot folder /results/clustifyr/","code":""},{"path":"https://mihem.github.io/scMisc/reference/clustifyFun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"clustifyr UMAP heatmap wrap — clustifyFun","text":"","code":"if (FALSE) { # \\dontrun{ clustifyFun(     my_object = tcells,     my_annotations = \"cluster\",     ref_object = projectil_til,     ref_annotations = \"functional.cluster\",     format = \"seurat\",     ortho = \"none\",     height = 25,     width = 10,     umap = TRUE,     color = col_vector,     name = \"projectil_til\" ) } # }"},{"path":"https://mihem.github.io/scMisc/reference/compStat.html","id":null,"dir":"Reference","previous_headings":"","what":"significance for boxplot — compStat","title":"significance for boxplot — compStat","text":"calculcate significance ggsignif","code":""},{"path":"https://mihem.github.io/scMisc/reference/compStat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"significance for boxplot — compStat","text":"","code":"compStat(x_var, group, data, paired)"},{"path":"https://mihem.github.io/scMisc/reference/compStat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"significance for boxplot — compStat","text":"x_var numeric variable (x formula x ~ group) group grouping variable (group formula x ~ group) data data frame containing variables paired logical value. want perform pair testing?","code":""},{"path":"https://mihem.github.io/scMisc/reference/compStat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"significance for boxplot — compStat","text":"data frame adjusted signficance values","code":""},{"path":"https://mihem.github.io/scMisc/reference/compStat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"significance for boxplot — compStat","text":"","code":"set.seed(123) data <- data.frame(   sample = c(paste0(\"CSF_P0\", 1:9)),   type = c(rep(\"control\", 4), rep(\"AIE\", 5)),   cluster1 = c(runif(4, 0, 1), runif(5, 99, 100)),   cluster2 = c(runif(4, 0, 70), runif(5, 20, 100)) ) compStat(x_var = c(\"cluster1\", \"cluster2\"), group = \"type\", data = data, paired = FALSE) #> # A tibble: 1 × 6 #>   .y.      group1 group2       p  p.adj p.adj.signif #>   <chr>    <chr>  <chr>    <dbl>  <dbl> <chr>        #> 1 cluster1 AIE    control 0.0159 0.0318 *"},{"path":"https://mihem.github.io/scMisc/reference/dotPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"nice Seurat dot plot — dotPlot","title":"nice Seurat dot plot — dotPlot","text":"create save nice Seurat dot plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nice Seurat dot plot — dotPlot","text":"","code":"dotPlot(   path,   object,   par,   dot_min,   scale = TRUE,   ortho = \"none\",   width = 10,   height = 10,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/dotPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nice Seurat dot plot — dotPlot","text":"path path markers.csv object Seurat object par column name markers.csv dot_min minimal dot size scale values scaled? (default: TRUE) ortho convert orthologues? Allowed values: none, mouse2human human2mouse width width output plot (default: 10) height height output plot (default: 10) dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"nice Seurat dot plot — dotPlot","text":"save dot plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"nice Seurat dot plot — dotPlot","text":"","code":"library(Seurat) markers <- data.frame(B = c(\"MS4A1\", \"CD79A\")) write.csv(markers, \"markers.csv\") dotPlot(   path = \"markers.csv\",   object = pbmc_small,   par = \"B\",   dot_min = 0.1,   dir_output = \".\" ) #> New names: #> • `` -> `...1` #> Rows: 2 Columns: 2 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \",\" #> chr (1): B #> dbl (1): ...1 #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #> no genes were converted #> Warning: Scaling data with a low number of groups may produce misleading results #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. #> Scale for size is already present. #> Adding another scale for size, which will replace the existing scale. #> Warning: Removed 3 rows containing missing values or values outside the scale range #> (`geom_point()`). #> Warning: Removed 3 rows containing missing values or values outside the scale range #> (`geom_point()`).  unlink(\"markers.csv\") unlink(\"dp_pbmc_small_B.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/dotplotPropeller.html","id":null,"dir":"Reference","previous_headings":"","what":"plot propeller results in a barplot — dotplotPropeller","title":"plot propeller results in a barplot — dotplotPropeller","text":"function creates barplot propeller results saves plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotplotPropeller.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot propeller results in a barplot — dotplotPropeller","text":"","code":"dotplotPropeller(   data,   color,   filename,   width = 5,   height = 5,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/dotplotPropeller.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot propeller results in a barplot — dotplotPropeller","text":"data dataframe containing results propeller calculation color vector colors clusters plot filename character representing file name plot width width plot height height plot dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotplotPropeller.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot propeller results in a barplot — dotplotPropeller","text":"create save propeller abundance barplot","code":""},{"path":"https://mihem.github.io/scMisc/reference/dotplotPropeller.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot propeller results in a barplot — dotplotPropeller","text":"","code":"propeller_data <- data.frame(      cluster = c(\"Cluster1\", \"Cluster2\", \"Cluster3\"),     log2ratio = c(1.5, -2.0, 0.5) ) color <- c(\"Cluster1\" = \"blue\", \"Cluster2\" = \"red\", \"Cluster3\" = \"green\") dotplotPropeller(data = propeller_data,  color = color,  filename = \"test_propeller_dotplot\",  width = 5,  height = 5,  dir_output = \".\")  unlink(\"propeller_dotplot_test_propeller_dotplot.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/enrichrRun.html","id":null,"dir":"Reference","previous_headings":"","what":"enrichment analysis — enrichrRun","title":"enrichment analysis — enrichrRun","text":"wrapper function perform enrichment analysis enrichr save results","code":""},{"path":"https://mihem.github.io/scMisc/reference/enrichrRun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"enrichment analysis — enrichrRun","text":"","code":"enrichrRun(   sheet,   dir_input = \".\",   filename,   dir_output = \".\",   dbs,   fc_thresh = 1,   p_thresh = 0.001,   remove_rp_mt )"},{"path":"https://mihem.github.io/scMisc/reference/enrichrRun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"enrichment analysis — enrichrRun","text":"sheet sheet name excel file dir_input path directory deg file located (default: .) filename name deg file file (.xlsx) without extension dir_output path directory results saved (default: .) dbs name enrichr libraries fc_thresh log fc threshold (default 1) p_thresh p value threshold (default 0.001) remove_rp_mt remove ribosomal mitochondrial genes? (boolean value)","code":""},{"path":"https://mihem.github.io/scMisc/reference/enrichrRun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"enrichment analysis — enrichrRun","text":"save enrichrment analysis dir_output two excel sheets (one positive one negative)","code":""},{"path":"https://mihem.github.io/scMisc/reference/enrichrRun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"enrichment analysis — enrichrRun","text":"","code":"library(Seurat) library(enrichR) #> Welcome to enrichR #> Checking connections ...  #> Enrichr ...  #> Connection is Live! #> FlyEnrichr ...  #> Connection is Live! #> WormEnrichr ...  #> Connection is Live! #> YeastEnrichr ...  #> Connection is Live! #> FishEnrichr ...  #> Connection is Live! #> OxEnrichr ...  #> Connection is Live! set.seed(123) deg_data <- data.frame(   gene = rownames(pbmc_small),   avg_log2FC = rnorm(length(rownames(pbmc_small)), mean = 0, sd = 3),   p_val_adj = runif(length(rownames(pbmc_small)), min = 0, max = 0.01) )  writexl::write_xlsx(deg_data, path = \"test_de.xlsx\") enrichrRun(   sheet = \"Sheet1\",   dir_input = \".\",   filename = \"test_de\",   dbs = c(\"KEGG_2019_Human\"),   fc_thresh = 1,   p_thresh = 0.001,   remove_rp_mt = FALSE ) #> Uploading data to Enrichr... Done. #>   Querying KEGG_2019_Human... Done. #> Parsing results... Done. #> Uploading data to Enrichr... Done. #>   Querying KEGG_2019_Human... Done. #> Parsing results... Done. unlink(\"test_de.xlsx\") unlink(\"enrichr_test_de_neg_Sheet1.xlsx\") unlink(\"enrichr_test_de_pos_Sheet1.xlsx\")"},{"path":"https://mihem.github.io/scMisc/reference/fPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Seurat feature plot — fPlot","title":"Seurat feature plot — fPlot","text":"create save nice Seurat feature plot folder featureplot","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Seurat feature plot — fPlot","text":"","code":"fPlot(   path,   object,   par,   reduction,   width = 16,   height = ceiling(length(genes_found)/4) * 3,   order,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/fPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Seurat feature plot — fPlot","text":"path path markers.csv object Seurat object par column name markers.csv reduction character string specifying dimension reduction width width output plot (default: 16) height height output plot (default: length genes divided four, ceiling, times three) order feature plot ordered order expression dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Seurat feature plot — fPlot","text":"save feature plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Seurat feature plot — fPlot","text":"","code":"library(Seurat) markers <- data.frame(B = c(\"MS4A1\", \"CD79A\")) write.csv(markers, \"markers.csv\") fPlot(   path = \"markers.csv\",   object = pbmc_small,   par = \"B\",   reduction = \"tsne\",   order = TRUE,   dir_output = \".\" ) #> New names: #> • `` -> `...1` #> Rows: 2 Columns: 2 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \",\" #> chr (1): B #> dbl (1): ...1 #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.  unlink(\"markers.csv\") unlink(\"fp_pbmc_small_B.png\")"},{"path":"https://mihem.github.io/scMisc/reference/fPlotCustom.html","id":null,"dir":"Reference","previous_headings":"","what":"Seurat feature plot — fPlotCustom","title":"Seurat feature plot — fPlotCustom","text":"create save Seurat feature plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlotCustom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Seurat feature plot — fPlotCustom","text":"","code":"fPlotCustom(   object,   markers,   par,   reduction,   width = 16,   height = ceiling(length(genes_found)/4) * 3,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/fPlotCustom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Seurat feature plot — fPlotCustom","text":"object Seurat object markers data frame column called cell_source represents cell population source column gene par character string representing cell_source plot reduction character string specifying dimension reduction width width output plot (default: 16) height height output plot (default: length genes divided four, ceiling, times three) dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlotCustom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Seurat feature plot — fPlotCustom","text":"save feature plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/fPlotCustom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Seurat feature plot — fPlotCustom","text":"","code":"library(Seurat) markers <- data.frame(cell_source = c(\"B\", \"B\"), gene = c(\"MS4A1\", \"CD79A\")) fPlotCustom(   object = pbmc_small,   markers = markers,   par = \"B\",   reduction = \"tsne\" )  unlink(\"fp_pbmc_small_B.png\")"},{"path":"https://mihem.github.io/scMisc/reference/findMarkersPresto.html","id":null,"dir":"Reference","previous_headings":"","what":"wrapper function for presto find markers — findMarkersPresto","title":"wrapper function for presto find markers — findMarkersPresto","text":"find significant DE genes using presto","code":""},{"path":"https://mihem.github.io/scMisc/reference/findMarkersPresto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"wrapper function for presto find markers — findMarkersPresto","text":"","code":"findMarkersPresto(   ident1,   ident2 = NULL,   object,   only_pos = FALSE,   min_pct = 0.1,   logfc_threshold = 0.25,   assay = assay )"},{"path":"https://mihem.github.io/scMisc/reference/findMarkersPresto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"wrapper function for presto find markers — findMarkersPresto","text":"ident1 cell population 1 ident2 cell population 2, NULL use (default: NULL) object Seurat object only_pos return positive markers? (default: FALSE) min_pct minimum fraction cells either two populations (default: 0.1) logfc_threshold minimum x-fold difference (default: 0.25) assay assay use DE testing (e.g. RNA SCT)","code":""},{"path":"https://mihem.github.io/scMisc/reference/findMarkersPresto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"wrapper function for presto find markers — findMarkersPresto","text":"data frame significant DE genes arranged log2FC","code":""},{"path":"https://mihem.github.io/scMisc/reference/findMarkersPresto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"wrapper function for presto find markers — findMarkersPresto","text":"","code":"library(Seurat) findMarkersPresto(ident1 = \"0\", ident2 = \"1\", object = pbmc_small, assay = \"RNA\") #> For a (much!) faster implementation of the Wilcoxon Rank Sum Test, #> (default method for FindMarkers) please install the presto package #> -------------------------------------------- #> install.packages('devtools') #> devtools::install_github('immunogenomics/presto') #> -------------------------------------------- #> After installation of presto, Seurat will automatically use the more  #> efficient implementation (no further action necessary). #> This message will be shown once per session #>         gene avg_log2FC        p_val    p_val_adj pct.1 pct.2 #> 1        CD7  11.172163 2.291671e-05 5.270843e-03 0.528  0.00 #> 2        LCK   6.298467 1.179184e-04 2.712123e-02 0.500  0.04 #> 3       CCL5   5.198553 6.564657e-05 1.509871e-02 0.667  0.28 #> 4     NFKBIA  -1.223713 1.892762e-04 4.353352e-02 0.278  0.88 #> 5       PSAP  -1.375977 5.632116e-05 1.295387e-02 0.417  1.00 #> 6       SAT1  -1.473774 1.394154e-04 3.206554e-02 0.639  1.00 #> 7     FCER1G  -1.513784 6.370800e-06 1.465284e-03 0.389  1.00 #> 8     CARD16  -1.630200 8.720825e-05 2.005790e-02 0.139  0.72 #> 9     TYROBP  -1.714096 4.686298e-07 1.077848e-04 0.444  1.00 #> 10 LINC00936  -1.800795 4.973217e-05 1.143840e-02 0.083  0.60 #> 11     COTL1  -1.829941 2.124963e-05 4.887414e-03 0.500  0.96 #> 12   S100A11  -1.839553 1.235720e-06 2.842157e-04 0.333  1.00 #> 13    LGALS1  -1.857736 5.123692e-07 1.178449e-04 0.500  1.00 #> 14     GSTP1  -2.010925 1.100905e-05 2.532081e-03 0.333  0.88 #> 15      CTSS  -2.078919 8.095594e-07 1.861987e-04 0.361  0.96 #> 16      TSPO  -2.148317 8.902375e-06 2.047546e-03 0.333  0.88 #> 17      FCN1  -2.438790 5.418631e-07 1.246285e-04 0.167  0.88 #> 18      AIF1  -2.626718 8.106490e-09 1.864493e-06 0.194  1.00 #> 19    LGALS3  -2.639987 4.816986e-06 1.107907e-03 0.111  0.72 #> 20       CFP  -2.819252 6.044000e-06 1.390120e-03 0.083  0.68 #> 21    NUP214  -2.820961 5.481682e-05 1.260787e-02 0.028  0.48 #> 22       GRN  -2.829504 7.180762e-07 1.651575e-04 0.083  0.76 #> 23       BID  -2.875011 2.976826e-06 6.846699e-04 0.083  0.72 #> 24   HLA-DMA  -3.007053 2.689683e-05 6.186270e-03 0.056  0.56 #> 25      CTSB  -3.045623 1.993113e-05 4.584160e-03 0.111  0.68 #> 26     FCGRT  -3.078474 3.166989e-08 7.284074e-06 0.083  0.84 #> 27       HCK  -3.092237 6.751546e-06 1.552856e-03 0.028  0.56 #> 28      LST1  -3.099086 1.969061e-09 4.528840e-07 0.139  0.96 #> 29    LGALS2  -3.247194 9.650274e-06 2.219563e-03 0.056  0.60 #> 30    IFITM3  -3.332581 2.301085e-08 5.292495e-06 0.056  0.80 #> 31    RNF130  -3.338908 2.473344e-05 5.688692e-03 0.056  0.56 #> 32     IFI30  -3.387459 6.624184e-07 1.523562e-04 0.028  0.64 #> 33   HLA-DRA  -3.450292 1.268278e-08 2.917039e-06 0.417  0.92 #> 34  HLA-DQB1  -3.505836 5.620640e-06 1.292747e-03 0.028  0.56 #> 35  SERPINA1  -3.540765 1.886774e-07 4.339580e-05 0.056  0.72 #> 36       CFD  -3.659355 1.963076e-06 4.515076e-04 0.056  0.64 #> 37      CST3  -3.710886 4.469249e-11 1.027927e-08 0.306  1.00 #> 38      TYMP  -3.806179 1.702818e-11 3.916481e-09 0.111  1.00 #> 39    LRRC25  -3.923695 1.256935e-04 2.890952e-02 0.028  0.44 #> 40  HLA-DRB5  -4.122944 3.920170e-08 9.016391e-06 0.056  0.76 #> 41  HLA-DPA1  -4.197597 7.347202e-09 1.689856e-06 0.111  0.84 #> 42       LYZ  -4.476489 6.997602e-11 1.609449e-08 0.417  1.00 #> 43  HLA-DQA1  -4.711130 1.136284e-05 2.613452e-03 0.028  0.52 #> 44      IL1B  -4.725789 2.948315e-05 6.781125e-03 0.028  0.48 #> 45     MPEG1  -4.803084 1.834020e-04 4.218246e-02 0.028  0.40 #> 46      FPR1  -4.912697 2.460668e-05 5.659537e-03 0.028  0.48 #> 47   HLA-DMB  -4.920761 2.145323e-05 4.934243e-03 0.028  0.48 #> 48  HLA-DRB1  -4.999548 3.287672e-10 7.561646e-08 0.083  0.88 #> 49    S100A9  -5.125239 1.542308e-09 3.547309e-07 0.194  0.88 #> 50  HLA-DPB1  -5.325399 4.061018e-10 9.340340e-08 0.083  0.88 #> 51    S100A8  -6.076803 5.334985e-11 1.227047e-08 0.111  0.96 #> 52     SMCO4  -9.369438 1.739832e-06 4.001614e-04 0.000  0.52 #> 53     C5AR1  -9.594401 1.556284e-05 3.579453e-03 0.000  0.44 #> 54      CD14  -9.883809 1.739832e-06 4.001614e-04 0.000  0.52 #> 55    MS4A6A -10.301974 1.739832e-06 4.001614e-04 0.000  0.52"},{"path":"https://mihem.github.io/scMisc/reference/lss.html","id":null,"dir":"Reference","previous_headings":"","what":"list objects from the environment in a pretty way — lss","title":"list objects from the environment in a pretty way — lss","text":"list objects environment, changes human-readable units arranges size. Taken https://stackoverflow.com//65949488.","code":""},{"path":"https://mihem.github.io/scMisc/reference/lss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"list objects from the environment in a pretty way — lss","text":"","code":"lss()"},{"path":"https://mihem.github.io/scMisc/reference/lss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"list objects from the environment in a pretty way — lss","text":"tibble environment objects arranged size","code":""},{"path":"https://mihem.github.io/scMisc/reference/pHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"nice pheatmap — pHeatmap","title":"nice pheatmap — pHeatmap","text":"create save nice pheatmap folder heatmap using color breaks","code":""},{"path":"https://mihem.github.io/scMisc/reference/pHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nice pheatmap — pHeatmap","text":"","code":"pHeatmap(   matrix,   scale = \"none\",   height = ceiling(nrow(matrix)/3),   width = ceiling(ncol(matrix)/2),   cellwidth = 10,   cellheight = 10,   treeheight_row = 10,   treeheight_col = 10,   fontsize = 10,   cluster_rows = TRUE,   cluster_cols = TRUE,   annotation_row = NA,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/pHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nice pheatmap — pHeatmap","text":"matrix numeric matrix values plotted scale values centered scaled row, column direction? Allowed: row, column, none (default: none) height height output plot (default: number rows divided three) width width output plot (default: number columns divided two) cellwidth individual cell width (default: 10) cellheight individual cell height (default: 10) treeheight_row height tree rows (default: 10) treeheight_col height tree columns (default: 10) fontsize fontsize (default: 10) cluster_rows cluster rows? (default: true) cluster_cols cluster columns? (default: true) annotation_row data frame contains annotations. Rows data annotation matched using row names. (default: NA) dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/pHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"nice pheatmap — pHeatmap","text":"save heatmap folder","code":""},{"path":"https://mihem.github.io/scMisc/reference/pHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"nice pheatmap — pHeatmap","text":"","code":"matrix <- matrix(rnorm(100), nrow = 10, ncol = 10) rownames(matrix) <- paste0(\"Gene\", 1:10) colnames(matrix) <- paste0(\"Sample\", 1:10) pHeatmap(matrix, scale = \"row\", dir_output = \".\")  #> agg_record_1140350788  #>                     2  unlink(\"hm_matrix.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/pcaSeurat.html","id":null,"dir":"Reference","previous_headings":"","what":"plot PCA of cluster abundances — pcaSeurat","title":"plot PCA of cluster abundances — pcaSeurat","text":"function creates PCA plot cluster abundances saves plot results/abundance folder","code":""},{"path":"https://mihem.github.io/scMisc/reference/pcaSeurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot PCA of cluster abundances — pcaSeurat","text":"","code":"pcaSeurat(   object,   cluster,   sample,   condition,   width = 20,   height = 5,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/pcaSeurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot PCA of cluster abundances — pcaSeurat","text":"object Seurat object cluster character string indicating cluster column metadata Seurat object sample character string indicating sample column metadata Seurat object condition character string indicating condition column metadata Seurat object width width plot height height plot dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/pcaSeurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot PCA of cluster abundances — pcaSeurat","text":"Create save PCA plot Seurat cluster abundances.","code":""},{"path":"https://mihem.github.io/scMisc/reference/pcaSeurat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot PCA of cluster abundances — pcaSeurat","text":"","code":"library(Seurat) # Setup example data set.seed(123) pbmc_small$cluster <- sample(c(\"Cluster1\", \"Cluster2\"), ncol(pbmc_small), replace = TRUE) pbmc_small$sample <- sample(c(\"CSF_P01\", \"CSF_P02\", \"CSF_P03\", \"CSF_P04\"),                             ncol(pbmc_small), replace = TRUE)  # Create lookup table for conditions lookup <- data.frame(   sample = c(\"CSF_P01\", \"CSF_P02\", \"CSF_P03\", \"CSF_P04\"),   condition = c(rep(\"control\", 2), rep(\"treatment\", 2)) )  # Add condition information to metadata pbmc_small@meta.data <- pbmc_small@meta.data |>   tibble::rownames_to_column(\"barcode\") |>   dplyr::left_join(lookup, by = \"sample\") |>   tibble::column_to_rownames(\"barcode\")  # Generate PCA plot pcaSeurat(   object = pbmc_small,   cluster = \"cluster\",   sample = \"sample\",    condition = \"condition\",   width = 20,   height = 5 ) #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the ggpubr package. #>   Please report the issue at <https://github.com/kassambara/ggpubr/issues>. #> Warning: `aes_string()` was deprecated in ggplot2 3.0.0. #> ℹ Please use tidy evaluation idioms with `aes()`. #> ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. #> ℹ The deprecated feature was likely used in the factoextra package. #>   Please report the issue at <https://github.com/kassambara/factoextra/issues>. #> Joining with `by = join_by(cluster)` #> Warning: Ignoring empty aesthetic: `width`. #> Ignoring unknown labels: #> • linetype : \"group\" #> • shape : \"group\" #> Warning: Ignoring empty aesthetic: `width`. #> Ignoring unknown labels: #> • linetype : \"group\" #> • shape : \"group\"  unlink(\"pbmc_small_condition_cluster.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://mihem.github.io/scMisc/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://mihem.github.io/scMisc/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://mihem.github.io/scMisc/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotEnrichr.html","id":null,"dir":"Reference","previous_headings":"","what":"enrichr plot — plotEnrichr","title":"enrichr plot — plotEnrichr","text":"plot enrichr results bar plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotEnrichr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"enrichr plot — plotEnrichr","text":"","code":"plotEnrichr(filename, sheet, width, height, dir_input = \".\", dir_output = \".\")"},{"path":"https://mihem.github.io/scMisc/reference/plotEnrichr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"enrichr plot — plotEnrichr","text":"filename name .xlsx file without extension without enrichr_ sheet name excel sheet width width output plot height height output plot dir_input directory input file (.xlsx) located (default: \".\") dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotEnrichr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"enrichr plot — plotEnrichr","text":"create save enrichr plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotEnrichr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"enrichr plot — plotEnrichr","text":"","code":"enrichr_data_go <- data.frame(   Term = c(\"Term1\", \"Term2\", \"Term3\"),   Adjusted.P.value = c(0.01, 0.02, 0.03),   Overlap = c(\"5/100\", \"10/200\", \"15/300\") ) enrichr_data <- list(\"GO_Biological_Process_2021\" = enrichr_data_go) writexl::write_xlsx(enrichr_data, \"./enrichr_test.xlsx\") plotEnrichr(   filename = \"test\",   sheet = \"GO_Biological_Process_2021\",   width = 10,   height = 5,   dir_output = \".\" )  unlink(\"enrichr_test.xlsx\") unlink(\"barplot_enrichr_test_GO_Biological_Process_2021.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/plotPropeller.html","id":null,"dir":"Reference","previous_headings":"","what":"plot propeller results — plotPropeller","title":"plot propeller results — plotPropeller","text":"function creates volcano plot propeller results saves ","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotPropeller.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot propeller results — plotPropeller","text":"","code":"plotPropeller(   data,   color,   filename,   width = 5,   height = 5,   FDR = NULL,   use_permFDP = FALSE,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/plotPropeller.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot propeller results — plotPropeller","text":"data dataframe containing results propeller calculation color vector colors clusters plot filename character representing file name plot width width plot height height plot FDR FDR threshold plot. Required unless use_permFDP = TRUE use_permFDP Logical indicating whether use permFDP threshold data (default: FALSE) dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotPropeller.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot propeller results — plotPropeller","text":"create save propeller plot","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotPropeller.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot propeller results — plotPropeller","text":"","code":"# Standard usage with BH-adjusted FDR propeller_data <- data.frame(   cluster = c(\"Cluster1\", \"Cluster2\", \"Cluster3\"),   log2ratio = c(1.5, -2.0, 0.5),   FDR_log = c(-log10(0.01), -log10(0.05), -log10(0.001)) ) color <- c(\"Cluster1\" = \"blue\", \"Cluster2\" = \"red\", \"Cluster3\" = \"green\") plotPropeller(   data = propeller_data,   color = color,   filename = \"test_propeller\",   width = 5,   height = 5,   FDR = 0.05,   dir_output = \".\" )  unlink(\"propeller_test_propeller.pdf\")  # With permFDP threshold propeller_data_permFDP <- data.frame(   cluster = c(\"Cluster1\", \"Cluster2\", \"Cluster3\"),   log2ratio = c(1.5, -2.0, 0.5),   FDR_log = c(-log10(0.01), -log10(0.05), -log10(0.001)),   permFDP_threshold = 0.025 ) plotPropeller(   data = propeller_data_permFDP,   color = color,   filename = \"test_propeller_permFDP\",   width = 5,   height = 5,   use_permFDP = TRUE,   dir_output = \".\" ) #> Using permFDP threshold: 0.025  unlink(\"propeller_test_propeller_permFDP.pdf\")"},{"path":"https://mihem.github.io/scMisc/reference/plotSlingshot.html","id":null,"dir":"Reference","previous_headings":"","what":"plot slingshot results — plotSlingshot","title":"plot slingshot results — plotSlingshot","text":"function creates colored UMAP plot curves split lineage","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotSlingshot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot slingshot results — plotSlingshot","text":"","code":"plotSlingshot(object, lineage, pt, curves)"},{"path":"https://mihem.github.io/scMisc/reference/plotSlingshot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot slingshot results — plotSlingshot","text":"object Seurat object lineage character string indicating lineage interest. pt numeric vector pseudotime values. curves dataframe containing curves.","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotSlingshot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot slingshot results — plotSlingshot","text":"ggplot object.","code":""},{"path":"https://mihem.github.io/scMisc/reference/plotSlingshot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot slingshot results — plotSlingshot","text":"","code":"library(Seurat) set.seed(123) pbmc_small$lineage <- sample(c(\"Lineage1\", \"Lineage2\"), ncol(pbmc_small), replace = TRUE) pbmc_small$umap <- CreateDimReducObject(  embeddings =    Embeddings(      pbmc_small,      reduction = \"tsne\"    ),  key = \"UMAP_\",  assay = \"RNA\" ) curves <- data.frame(     UMAP_1 = runif(ncol(pbmc_small), min = -10, max = 10),     UMAP_2 = runif(ncol(pbmc_small), min = -10, max = 10),     Lineage = sample(c(\"Lineage1\", \"Lineage2\"), ncol(pbmc_small), replace = TRUE) ) pt <- matrix(runif(ncol(pbmc_small) * 2), ncol = 2) colnames(pt) <- c(\"Lineage1\", \"Lineage2\") plot <- plotSlingshot(object = pbmc_small, lineage = \"Lineage1\", pt = pt, curves = curves)"},{"path":"https://mihem.github.io/scMisc/reference/propellerCalc.html","id":null,"dir":"Reference","previous_headings":"","what":"propellerCalc — propellerCalc","title":"propellerCalc — propellerCalc","text":"perform propeller t-test Seurat object","code":""},{"path":"https://mihem.github.io/scMisc/reference/propellerCalc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"propellerCalc — propellerCalc","text":"","code":"propellerCalc(   seu_obj1,   condition1,   condition2,   cluster_col,   meta_col,   lookup,   sample_col,   formula,   min_cells = 30,   adjustment_method = \"BH\",   fdr_threshold = NULL,   n_perms = 1000 )"},{"path":"https://mihem.github.io/scMisc/reference/propellerCalc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"propellerCalc — propellerCalc","text":"seu_obj1 seurat object condition1 character representing first condition condition2 character representing second condition cluster_col character representing name column contains cluster information meta_col character representing name column contains meta information, Seurat object lookup table lookup dataframe contains sample information sample_col character representing name column seu_obj1 contains sample information formula linear model used design matrix min_cells numeric value indicating minimum number cells cluster included analysis adjustment_method character indicating FDR adjustment method: \"BH\" (default) \"permFDP\" fdr_threshold FDR threshold use permFDP adjustment (default: NULL) n_perms Number permutations permFDP adjustment (default: 1000)","code":""},{"path":"https://mihem.github.io/scMisc/reference/propellerCalc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"propellerCalc — propellerCalc","text":"dataframe containing results t-test","code":""},{"path":"https://mihem.github.io/scMisc/reference/propellerCalc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"propellerCalc — propellerCalc","text":"","code":"set.seed(123) library(Seurat) pbmc_small$condition <- factor(sample(c(\"diseaseA\", \"diseaseB\"), nrow(pbmc_small), replace = TRUE)) pbmc_small$cluster <- Idents(pbmc_small) pbmc_small$patient <- rep(paste0(\"P\", 0:9), each = 8, length.out = ncol(pbmc_small)) lookup <- data.frame(   patient = paste0(\"P\", 0:9),   condition = sample(c(\"diseaseA\", \"diseaseB\"), 10, replace = TRUE) ) # Standard BH adjustment propellerCalc(   seu_obj1 = pbmc_small,   condition1 = \"diseaseA\",   condition2 = \"diseaseB\",   cluster_col = \"cluster\",   meta_col = \"condition\",   lookup = lookup,   sample_col = \"patient\",   formula = \"~ 0 + condition\",   min_cells = 30 ) #> Performing logit transformation of proportions #> # A tibble: 1 × 9 #>   cluster PropMean.conditiondiseaseA PropMean.conditiondi…¹ PropRatio Tstatistic #>   <chr>                        <dbl>                  <dbl>     <dbl>      <dbl> #> 1 0                            0.667                  0.357      1.87       1.28 #> # ℹ abbreviated name: ¹​PropMean.conditiondiseaseB #> # ℹ 4 more variables: P.Value <dbl>, FDR <dbl>, log2ratio <dbl>, FDR_log <dbl>  # With permFDP adjustment (use lower min_cells to have multiple clusters) propellerCalc(   seu_obj1 = pbmc_small,   condition1 = \"diseaseA\",   condition2 = \"diseaseB\",   cluster_col = \"cluster\",   meta_col = \"condition\",   lookup = lookup,   sample_col = \"patient\",   formula = \"~ 0 + condition\",   min_cells = 5,   adjustment_method = \"permFDP\",   fdr_threshold = 0.1,   n_perms = 100 ) #> Performing logit transformation of proportions #> Running permFDP with 100 permutations for diseaseA vs diseaseB (3 clusters, 10 samples)... #>   -> Corrected threshold: 0.0744 #> # A tibble: 3 × 11 #>   cluster PropMean.conditiondiseaseA PropMean.conditiondi…¹ PropRatio Tstatistic #>   <chr>                        <dbl>                  <dbl>     <dbl>      <dbl> #> 1 2                           0.0417                  0.321     0.130    -1.49   #> 2 0                           0.667                   0.357     1.87      1.28   #> 3 1                           0.292                   0.321     0.907    -0.0823 #> # ℹ abbreviated name: ¹​PropMean.conditiondiseaseB #> # ℹ 6 more variables: P.Value <dbl>, FDR <dbl>, log2ratio <dbl>, FDR_log <dbl>, #> #   permFDP_sig <lgl>, permFDP_threshold <dbl>"},{"path":"https://mihem.github.io/scMisc/reference/scale_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"scale matrix from pheatmap only internal use — scale_mat","title":"scale matrix from pheatmap only internal use — scale_mat","text":"copied pheatmap internal use","code":""},{"path":"https://mihem.github.io/scMisc/reference/scale_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scale matrix from pheatmap only internal use — scale_mat","text":"","code":"scale_mat(mat, scale)"},{"path":"https://mihem.github.io/scMisc/reference/scale_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scale matrix from pheatmap only internal use — scale_mat","text":"mat matrix input scale values centered scaled row, column direction? Allowed: row, column, none","code":""},{"path":"https://mihem.github.io/scMisc/reference/scale_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"scale matrix from pheatmap only internal use — scale_mat","text":"matrix scaled","code":""},{"path":"https://mihem.github.io/scMisc/reference/scale_rows.html","id":null,"dir":"Reference","previous_headings":"","what":"scale rows from pheatmap only internal use — scale_rows","title":"scale rows from pheatmap only internal use — scale_rows","text":"copied pheatmap internal use","code":""},{"path":"https://mihem.github.io/scMisc/reference/scale_rows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scale rows from pheatmap only internal use — scale_rows","text":"","code":"scale_rows(x)"},{"path":"https://mihem.github.io/scMisc/reference/scale_rows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scale rows from pheatmap only internal use — scale_rows","text":"x matrix input","code":""},{"path":"https://mihem.github.io/scMisc/reference/scale_rows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"scale rows from pheatmap only internal use — scale_rows","text":"matrix scaled rows","code":""},{"path":"https://mihem.github.io/scMisc/reference/stackedPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"abundance stacked bar plot — stackedPlot","title":"abundance stacked bar plot — stackedPlot","text":"create save abundance stacked bar plot folder abundance","code":""},{"path":"https://mihem.github.io/scMisc/reference/stackedPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"abundance stacked bar plot — stackedPlot","text":"","code":"stackedPlot(   object,   x_axis,   y_axis,   x_order,   y_order,   color,   width,   height = 10,   dir_output = \".\" )"},{"path":"https://mihem.github.io/scMisc/reference/stackedPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"abundance stacked bar plot — stackedPlot","text":"object Seurat object x_axis variable meta data used y axis y_axis variable meta data used x axis x_order vector determining order x axis y_order vector determining order y axis color color palette width width output plot (default: 10) height height output plot dir_output directory save output plot (default: \".\")","code":""},{"path":"https://mihem.github.io/scMisc/reference/stackedPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"abundance stacked bar plot — stackedPlot","text":"save stacked abundance barplot","code":""},{"path":"https://mihem.github.io/scMisc/reference/stackedPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"abundance stacked bar plot — stackedPlot","text":"","code":"if (FALSE) { # \\dontrun{ stackedPlot(   object = sc_merge,   x_axis = \"pool\",   y_axis = \"cluster\",   x_order = unique(sc_merge$pool),   y_order = cluster_order,   color = col_vector,   width = 4 ) } # }"},{"path":"https://mihem.github.io/scMisc/reference/theme_rect.html","id":null,"dir":"Reference","previous_headings":"","what":"nice ggplot theme — theme_rect","title":"nice ggplot theme — theme_rect","text":"nice theme square border","code":""},{"path":"https://mihem.github.io/scMisc/reference/theme_rect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nice ggplot theme — theme_rect","text":"","code":"theme_rect()"},{"path":"https://mihem.github.io/scMisc/reference/theme_rect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"nice ggplot theme — theme_rect","text":"","code":"library(ggplot2) p <- ggplot(mtcars, aes(x = wt, y = mpg)) +   geom_point() p + theme_rect()"}]
